{"version":3,"file":"src_components_workers_embeddings_tsne_worker_ts.js","mappings":"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EkC,CAAC,CAACoB,IAAF,CAAOI,MAAP,CAAcC,YADM;MAE7BpF,UAAU,EAAE2D,CAAC,CAACoB,IAAF,CAAOI,MAAP,CAAcnF,UAFG;MAG7BwB,GAAG,EAAE,CAHwB;MAI7B5B,UAAU,EAAEnD,2EAAe,CAACkH,CAAC,CAACoB,IAAF,CAAOI,MAAP,CAAcE,cAAf,EAA+B1B,CAA/B;IAJE,CAAhB,CAAf;IAMAmB,OAAO,CAACI,IAAR,CAAanD,cAAb,CAA4B4B,CAAC,CAACoB,IAAF,CAAOO,KAAnC,EAA0C3B,CAAC,CAACoB,IAAF,CAAOI,MAAP,CAAcI,MAAd,GAAuB5B,CAAC,CAACoB,IAAF,CAAO/C,IAA9B,GAAqCS,SAA/E;IACAqC,OAAO,CAACI,IAAR,CAAapC,IAAb;IACAgC,OAAO,CAACU,WAAR,CAAoBV,OAAO,CAACI,IAAR,CAAarC,WAAb,EAApB;EACD,CAXD,MAWO,IAAIiC,OAAO,CAACI,IAAR,IAAgB,IAApB,EAA0B;IAC/BJ,OAAO,CAACI,IAAR,CAAapC,IAAb;IACAgC,OAAO,CAACU,WAAR,CAAoBV,OAAO,CAACI,IAAR,CAAarC,WAAb,EAApB;EACD;AACF,CAnBH,EAoBE,KApBF;;;;;;UCzaA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;;;;WClCA;WACA;WACA;WACA;WACA,+BAA+B,wCAAwC;WACvE;WACA;WACA;WACA;WACA,iBAAiB,qBAAqB;WACtC;WACA;WACA,kBAAkB,qBAAqB;WACvC;WACA;WACA,KAAK;WACL;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;;;;WC3BA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,EAAE;WACF;;;;;WCRA;WACA;WACA;WACA;WACA;;;;;WCJA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;WCNA;;;;;WCAA;;WAEA;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,aAAa;WACb;WACA;WACA;WACA;;WAEA;WACA;WACA;;WAEA;;WAEA;;;;;WCpCA;WACA;WACA;WACA;WACA;WACA;WACA;;;;;UENA;UACA","sources":["webpack://PSE/webpack/universalModuleDefinition","webpack://PSE/./src/components/workers/embeddings/tsne.worker.ts","webpack://PSE/webpack/bootstrap","webpack://PSE/webpack/runtime/chunk loaded","webpack://PSE/webpack/runtime/compat get default export","webpack://PSE/webpack/runtime/define property getters","webpack://PSE/webpack/runtime/ensure chunk","webpack://PSE/webpack/runtime/get javascript chunk filename","webpack://PSE/webpack/runtime/hasOwnProperty shorthand","webpack://PSE/webpack/runtime/make namespace object","webpack://PSE/webpack/runtime/publicPath","webpack://PSE/webpack/runtime/importScripts chunk loading","webpack://PSE/webpack/runtime/startup chunk dependencies","webpack://PSE/webpack/before-startup","webpack://PSE/webpack/startup","webpack://PSE/webpack/after-startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PSE\"] = factory();\n\telse\n\t\troot[\"PSE\"] = factory();\n})(self, () => {\nreturn ","import 'regenerator-runtime/runtime';\nimport { euclidean, jaccard } from '../../Utility/UMAP/umap';\nimport { get_distance_fn } from '../../Utility/DistanceFunctions';\n\n// create main global object\nvar tsnejs = tsnejs || { REVISION: 'ALPHA' };\n\n(function (global) {\n  // utility function\n  const assert = function (condition, message) {\n    if (!condition) {\n      throw message || 'Assertion failed';\n    }\n  };\n\n  // syntax sugar\n  const getopt = function (opt, field, defaultval) {\n    if (opt.hasOwnProperty(field)) {\n      return opt[field];\n    }\n    return defaultval;\n  };\n\n  // return 0 mean unit standard deviation random number\n  let return_v = false;\n  let v_val = 0.0;\n  var gaussRandom = function () {\n    if (return_v) {\n      return_v = false;\n      return v_val;\n    }\n    const u = 2 * Math.random() - 1;\n    const v = 2 * Math.random() - 1;\n    const r = u * u + v * v;\n    if (r == 0 || r > 1) return gaussRandom();\n    const c = Math.sqrt((-2 * Math.log(r)) / r);\n    v_val = v * c; // cache this for next function call for efficiency\n    return_v = true;\n    return u * c;\n  };\n\n  // return random normal number\n  const randn = function (mu, std) {\n    return mu + gaussRandom() * std;\n  };\n\n  // utilitity that creates contiguous vector of zeros of size n\n  const zeros = function (n) {\n    if (typeof n === 'undefined' || isNaN(n)) {\n      return [];\n    }\n    if (typeof ArrayBuffer === 'undefined') {\n      // lacking browser support\n      const arr = new Array(n);\n      for (let i = 0; i < n; i++) {\n        arr[i] = 0;\n      }\n      return arr;\n    }\n    return new Float64Array(n); // typed arrays are faster\n  };\n\n  // utility that returns 2d array filled with random numbers\n  // or with value s, if provided\n  const randn2d = function (n, d, s) {\n    const uses = typeof s !== 'undefined';\n    const x = [];\n    for (let i = 0; i < n; i++) {\n      const xhere = [];\n      for (let j = 0; j < d; j++) {\n        if (uses) {\n          xhere.push(s);\n        } else {\n          xhere.push(randn(0.0, 1e-4));\n        }\n      }\n      x.push(xhere);\n    }\n    return x;\n  };\n\n  // compute L2 distance between two vectors\n  const L2 = function (x1, x2) {\n    const D = x1.length;\n    let d = 0;\n    for (let i = 0; i < D; i++) {\n      const x1i = x1[i];\n      const x2i = x2[i];\n      d += (x1i - x2i) * (x1i - x2i);\n    }\n    return d;\n  };\n\n  // compute pairwise distance in all vectors in X\n  const xtod = function (X, distanceFn) {\n    const N = X.length;\n    const dist = zeros(N * N); // allocate contiguous array\n    for (let i = 0; i < N; i++) {\n      for (let j = i + 1; j < N; j++) {\n        const d = distanceFn(X[i], X[j]);\n        dist[i * N + j] = d;\n        dist[j * N + i] = d;\n      }\n    }\n    return dist;\n  };\n\n  // compute (p_{i|j} + p_{j|i})/(2n)\n  const d2p = function (D, perplexity, tol) {\n    const Nf = Math.sqrt(D.length); // this better be an integer\n    const N = Math.floor(Nf);\n    assert(N === Nf, 'D should have square number of elements.');\n    const Htarget = Math.log(perplexity); // target entropy of distribution\n    const P = zeros(N * N); // temporary probability matrix\n\n    const prow = zeros(N); // a temporary storage compartment\n    for (var i = 0; i < N; i++) {\n      let betamin = -Infinity;\n      let betamax = Infinity;\n      let beta = 1; // initial value of precision\n      let done = false;\n      const maxtries = 50;\n\n      // perform binary search to find a suitable precision beta\n      // so that the entropy of the distribution is appropriate\n      let num = 0;\n      while (!done) {\n        // debugger;\n\n        // compute entropy and kernel row with beta precision\n        let psum = 0.0;\n        for (var j = 0; j < N; j++) {\n          var pj = Math.exp(-D[i * N + j] * beta);\n          if (i === j) {\n            pj = 0;\n          } // we dont care about diagonals\n          prow[j] = pj;\n          psum += pj;\n        }\n        // normalize p and compute entropy\n        let Hhere = 0.0;\n        for (var j = 0; j < N; j++) {\n          if (psum == 0) {\n            var pj = 0;\n          } else {\n            var pj = prow[j] / psum;\n          }\n          prow[j] = pj;\n          if (pj > 1e-7) Hhere -= pj * Math.log(pj);\n        }\n\n        // adjust beta based on result\n        if (Hhere > Htarget) {\n          // entropy was too high (distribution too diffuse)\n          // so we need to increase the precision for more peaky distribution\n          betamin = beta; // move up the bounds\n          if (betamax === Infinity) {\n            beta *= 2;\n          } else {\n            beta = (beta + betamax) / 2;\n          }\n        } else {\n          // converse case. make distrubtion less peaky\n          betamax = beta;\n          if (betamin === -Infinity) {\n            beta /= 2;\n          } else {\n            beta = (beta + betamin) / 2;\n          }\n        }\n\n        // stopping conditions: too many tries or got a good precision\n        num++;\n        if (Math.abs(Hhere - Htarget) < tol) {\n          done = true;\n        }\n        if (num >= maxtries) {\n          done = true;\n        }\n      }\n\n      // console.log('data point ' + i + ' gets precision ' + beta + ' after ' + num + ' binary search steps.');\n      // copy over the final prow to P at row i\n      for (var j = 0; j < N; j++) {\n        P[i * N + j] = prow[j];\n      }\n    } // end loop over examples i\n\n    // symmetrize P and normalize it to sum to 1 over all ij\n    const Pout = zeros(N * N);\n    const N2 = N * 2;\n    for (var i = 0; i < N; i++) {\n      for (var j = 0; j < N; j++) {\n        Pout[i * N + j] = Math.max((P[i * N + j] + P[j * N + i]) / N2, 1e-100);\n      }\n    }\n\n    return Pout;\n  };\n\n  // helper function\n  function sign(x) {\n    return x > 0 ? 1 : x < 0 ? -1 : 0;\n  }\n\n  const tSNE = function (opt) {\n    var opt = opt || {};\n    this.perplexity = getopt(opt, 'perplexity', 30); // effective number of nearest neighbors\n    this.dim = getopt(opt, 'dim', 2); // by default 2-D tSNE\n    this.epsilon = getopt(opt, 'epsilon', 10); // learning rate\n    this.distanceFn = getopt(opt, 'distanceFn', euclidean);\n\n    this.iter = 0;\n  };\n\n  tSNE.prototype = {\n    // this function takes a set of high-dimensional points\n    // and creates matrix P from them using gaussian kernel\n    initDataRaw(X) {\n      const N = X.length;\n      const D = X[0].length;\n      assert(N > 0, ' X is empty? You must have some data!');\n      assert(D > 0, ' X[0] is empty? Where is the data?');\n      const dists = xtod(X, this.distanceFn); // convert X to distances using gaussian kernel\n      this.P = d2p(dists, this.perplexity, 1e-4); // attach to object\n      this.N = N; // back up the size of the dataset\n      this.initSolution(); // refresh this\n    },\n\n    initDataSeeded(X, seed) {\n      const N = X.length;\n      const D = X[0].length;\n      assert(N > 0, ' X is empty? You must have some data!');\n      assert(D > 0, ' X[0] is empty? Where is the data?');\n      const dists = xtod(X, this.distanceFn); // convert X to distances using gaussian kernel\n      this.P = d2p(dists, this.perplexity, 1e-4); // attach to object\n      this.N = N; // back up the size of the dataset\n\n      // generate random solution to t-SNE\n      if (seed) {\n        const maxX = Math.max(...seed.map((s) => s[0]));\n        const minX = Math.min(...seed.map((s) => s[0]));\n        const maxY = Math.max(...seed.map((s) => s[1]));\n        const minY = Math.min(...seed.map((s) => s[1]));\n\n        const abs = Math.max(Math.abs(minX), Math.abs(maxX), Math.abs(minY), Math.abs(maxY));\n\n        const result = [];\n        for (let i = 0; i < this.N; i++) {\n          result.push([seed[i][0] / abs / 1000, seed[i][1] / abs / 1000]);\n        }\n        this.Y = result;\n      } else {\n        this.Y = randn2d(this.N, this.dim, undefined); // the solution\n      }\n\n      this.gains = randn2d(this.N, this.dim, 1.0); // step gains to accelerate progress in unchanging directions\n      this.ystep = randn2d(this.N, this.dim, 0.0); // momentum accumulator\n      this.iter = 0;\n    },\n\n    // this function takes a given distance matrix and creates\n    // matrix P from them.\n    // D is assumed to be provided as a list of lists, and should be symmetric\n    initDataDist(D) {\n      const N = D.length;\n      assert(N > 0, ' X is empty? You must have some data!');\n      // convert D to a (fast) typed array version\n      const dists = zeros(N * N); // allocate contiguous array\n      for (let i = 0; i < N; i++) {\n        for (let j = i + 1; j < N; j++) {\n          const d = D[i][j];\n          dists[i * N + j] = d;\n          dists[j * N + i] = d;\n        }\n      }\n      this.P = d2p(dists, this.perplexity, 1e-4);\n      this.N = N;\n      this.initSolution(); // refresh this\n    },\n\n    // (re)initializes the solution to random\n    initSolution() {\n      // generate random solution to t-SNE\n      this.Y = randn2d(this.N, this.dim, undefined); // the solution\n      this.gains = randn2d(this.N, this.dim, 1.0); // step gains to accelerate progress in unchanging directions\n      this.ystep = randn2d(this.N, this.dim, 0.0); // momentum accumulator\n      this.iter = 0;\n    },\n\n    // return pointer to current solution\n    getSolution() {\n      return this.Y;\n    },\n\n    // perform a single step of optimization to improve the embedding\n    step() {\n      this.iter += 1;\n      const { N } = this;\n\n      const cg = this.costGrad(this.Y); // evaluate gradient\n      const { cost } = cg;\n      const { grad } = cg;\n\n      // perform gradient step\n      const ymean = zeros(this.dim);\n      for (var i = 0; i < N; i++) {\n        for (var d = 0; d < this.dim; d++) {\n          const gid = grad[i][d];\n          const sid = this.ystep[i][d];\n          const gainid = this.gains[i][d];\n\n          // compute gain update\n          let newgain = sign(gid) === sign(sid) ? gainid * 0.8 : gainid + 0.2;\n          if (newgain < 0.01) newgain = 0.01; // clamp\n          this.gains[i][d] = newgain; // store for next turn\n\n          // compute momentum step direction\n          const momval = this.iter < 250 ? 0.5 : 0.8;\n          const newsid = momval * sid - this.epsilon * newgain * grad[i][d];\n          this.ystep[i][d] = newsid; // remember the step we took\n\n          // step!\n          this.Y[i][d] += newsid;\n\n          ymean[d] += this.Y[i][d]; // accumulate mean so that we can center later\n        }\n      }\n\n      // reproject Y to be zero mean\n      for (var i = 0; i < N; i++) {\n        for (var d = 0; d < this.dim; d++) {\n          this.Y[i][d] -= ymean[d] / N;\n        }\n      }\n\n      // if(this.iter%100===0) console.log('iter ' + this.iter + ', cost: ' + cost);\n      return cost; // return current cost\n    },\n\n    // for debugging: gradient check\n    debugGrad() {\n      const { N } = this;\n\n      const cg = this.costGrad(this.Y); // evaluate gradient\n      const { cost } = cg;\n      const { grad } = cg;\n\n      const e = 1e-5;\n      for (let i = 0; i < N; i++) {\n        for (let d = 0; d < this.dim; d++) {\n          const yold = this.Y[i][d];\n\n          this.Y[i][d] = yold + e;\n          const cg0 = this.costGrad(this.Y);\n\n          this.Y[i][d] = yold - e;\n          const cg1 = this.costGrad(this.Y);\n\n          const analytic = grad[i][d];\n          const numerical = (cg0.cost - cg1.cost) / (2 * e);\n\n          this.Y[i][d] = yold;\n        }\n      }\n    },\n\n    // return cost and gradient, given an arrangement\n    costGrad(Y) {\n      const { N } = this;\n      const { dim } = this; // dim of output space\n      const { P } = this;\n\n      const pmul = this.iter < 100 ? 4 : 1; // trick that helps with local optima\n\n      // compute current Q distribution, unnormalized first\n      const Qu = zeros(N * N);\n      let qsum = 0.0;\n      for (var i = 0; i < N; i++) {\n        for (var j = i + 1; j < N; j++) {\n          let dsum = 0.0;\n          for (var d = 0; d < dim; d++) {\n            const dhere = Y[i][d] - Y[j][d];\n            dsum += dhere * dhere;\n          }\n          const qu = 1.0 / (1.0 + dsum); // Student t-distribution\n          Qu[i * N + j] = qu;\n          Qu[j * N + i] = qu;\n          qsum += 2 * qu;\n        }\n      }\n      // normalize Q distribution to sum to 1\n      const NN = N * N;\n      const Q = zeros(NN);\n      for (let q = 0; q < NN; q++) {\n        Q[q] = Math.max(Qu[q] / qsum, 1e-100);\n      }\n\n      let cost = 0.0;\n      const grad = [];\n      for (var i = 0; i < N; i++) {\n        const gsum = new Array(dim); // init grad for point i\n        for (var d = 0; d < dim; d++) {\n          gsum[d] = 0.0;\n        }\n        for (var j = 0; j < N; j++) {\n          cost += -P[i * N + j] * Math.log(Q[i * N + j]); // accumulate cost (the non-constant portion at least...)\n          const premult = 4 * (pmul * P[i * N + j] - Q[i * N + j]) * Qu[i * N + j];\n          for (var d = 0; d < dim; d++) {\n            gsum[d] += premult * (Y[i][d] - Y[j][d]);\n          }\n        }\n        grad.push(gsum);\n      }\n\n      return { cost, grad };\n    },\n  };\n\n  global.tSNE = tSNE; // export tSNE class\n})(tsnejs);\n\n/**\n * Worker thread that computes a stepwise projection\n */\nself.addEventListener(\n  'message',\n  function (e) {\n    const context = self as any;\n    if (e.data.messageType == 'init') {\n      context.raw = e.data;\n      context.tsne = new tsnejs.tSNE({\n        epsilon: e.data.params.learningRate,\n        perplexity: e.data.params.perplexity,\n        dim: 2,\n        distanceFn: get_distance_fn(e.data.params.distanceMetric, e),\n      });\n      context.tsne.initDataSeeded(e.data.input, e.data.params.seeded ? e.data.seed : undefined);\n      context.tsne.step();\n      context.postMessage(context.tsne.getSolution());\n    } else if (context.tsne != null) {\n      context.tsne.step();\n      context.postMessage(context.tsne.getSolution());\n    }\n  },\n  false,\n);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendors-node_modules_jaccard_jaccard_js-node_modules_ml-levenberg-marquardt_src_index_js-node-e431cd\",\"src_components_Utility_DistanceFunctions_ts-src_components_Utility_UMAP_umap_ts\"], () => (__webpack_require__(\"./src/components/workers/embeddings/tsne.worker.ts\")))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".js\";\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t\"src_components_workers_embeddings_tsne_worker_ts\": 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkPSE\"] = self[\"webpackChunkPSE\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn Promise.all([\n\t\t__webpack_require__.e(\"vendors-node_modules_jaccard_jaccard_js-node_modules_ml-levenberg-marquardt_src_index_js-node-e431cd\"),\n\t\t__webpack_require__.e(\"src_components_Utility_DistanceFunctions_ts-src_components_Utility_UMAP_umap_ts\")\n\t]).then(next);\n};","","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n",""],"names":["euclidean","get_distance_fn","tsnejs","REVISION","global","assert","condition","message","getopt","opt","field","defaultval","hasOwnProperty","return_v","v_val","gaussRandom","u","Math","random","v","r","c","sqrt","log","randn","mu","std","zeros","n","isNaN","ArrayBuffer","arr","Array","i","Float64Array","randn2d","d","s","uses","x","xhere","j","push","L2","x1","x2","D","length","x1i","x2i","xtod","X","distanceFn","N","dist","d2p","perplexity","tol","Nf","floor","Htarget","P","prow","betamin","Infinity","betamax","beta","done","maxtries","num","psum","pj","exp","Hhere","abs","Pout","N2","max","sign","tSNE","dim","epsilon","iter","prototype","initDataRaw","dists","initSolution","initDataSeeded","seed","maxX","map","minX","min","maxY","minY","result","Y","undefined","gains","ystep","initDataDist","getSolution","step","cg","costGrad","cost","grad","ymean","gid","sid","gainid","newgain","momval","newsid","debugGrad","e","yold","cg0","cg1","analytic","numerical","pmul","Qu","qsum","dsum","dhere","qu","NN","Q","q","gsum","premult","self","addEventListener","context","data","messageType","raw","tsne","params","learningRate","distanceMetric","input","seeded","postMessage"],"sourceRoot":""}